<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Airline Passengers Data Analysis &mdash; SciBits.org</title>
  <meta name="author" content="Mangs">

  <link rel="canonical" href="/airpsg.html"/>
  
  <meta property="og:site_name" content="SciBits.org" />
  <meta property="og:type" content="article" />
    
  <meta property="og:title" content="Airline Passengers Data Analysis" />
  <meta property="og:url" content="/airpsg.html" />
  <meta property="og:description" content="For sometime I've been thinking about holidays and how travelling during these days might be different than rest of the year. Since most of the people travel during holidays, there is a very good possibility of having some seasonal bias in the data. Let's start with analysis of the information given in the Airline Passengers data set. The data consists of monthly totals of airline passengers from January 1949 to December 1960. Sample size: n = 144, Number: the monthly passenger totals in thousands." />
  <meta property="article:published_time" content="2017-12-30 07:20:00-08:00" />
  <meta property="article:modified_time" content="2017-12-30 07:20:00-08:00" />






  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="/favicon.png" rel="icon">

  <link href="/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">

  <script src="/theme/js/modernizr-2.0.js"></script>
  <script src="/theme/js/ender.js"></script>
  <script src="/theme/js/octopress.js" type="text/javascript"></script>
</head>

<body >
  <header role="banner"
  >
<hgroup>
  <h1><a href="/">SciBits.org</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
    <li><a href="/archives.html">Archives</a></li>
    <li><a href="/pages/about.html">About</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Airline Passengers Data Analysis</h1>
    <p class="meta">
<time datetime="2017-12-30T07:20:00-08:00" pubdate>Sat 30 December 2017</time>      
    </p>
</header>

    <div class="entry-content"><p>For sometime I've been thinking about holidays and how travelling during these days might be different than rest of the year. Since most of the people travel during holidays, there is a very good possibility of having some seasonal bias in the data. Let's start with analysis of the information given in the Airline Passengers data set. The data consists of monthly totals of airline passengers from January 1949 to December 1960. Sample size: n = 144, Number:  the monthly passenger totals in thousands. </p>
<p>We'll use the following forecasting methods for the time series data:<br/>
(1) Moving Average <br/>
(2) Single/Simple Exponential Smoothing Method<br/>
(3) Double Exponential Smoothing<br/>
(4) Triple Exponential Smoothing<br/>
(5) Auto Regressive Integrated Moving Average Method<br/>
(6) Neural Network Based Forecasting</p>
<p>We begin with importing the libraries.</p>
<div class="highlight"><pre><span></span><span class="c1">#use/import the required libraries</span>
<span class="kn">library</span><span class="p">(</span>forecast<span class="p">)</span>
</pre></div>


<p>Here we are going to create a time series data from 1100 to 1200 for illustration purposes.</p>
<div class="highlight"><pre><span></span><span class="c1">#numbers from 1100 to 1200</span>
tsData <span class="o">&lt;-</span> <span class="m">1100</span><span class="o">:</span><span class="m">1200</span>
tsData
</pre></div>


<p>1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 1198 1199 1200 </p>
<p>Converting the time series to quaterly data.</p>
<div class="highlight"><pre><span></span><span class="c1">#converting the numbers to time series. Frquency of 4 indicating quarterly </span>
ts<span class="p">(</span>tsData<span class="p">,</span> frequency <span class="o">=</span> <span class="m">4</span><span class="p">,</span>start <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2010</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>     Qtr1 Qtr2 Qtr3 Qtr4
2010 1100 1101 1102 1103
2011 1104 1105 1106 1107
2012 1108 1109 1110 1111
2013 1112 1113 1114 1115
2014 1116 1117 1118 1119
2015 1120 1121 1122 1123
2016 1124 1125 1126 1127
2017 1128 1129 1130 1131
2018 1132 1133 1134 1135
2019 1136 1137 1138 1139
2020 1140 1141 1142 1143
2021 1144 1145 1146 1147
2022 1148 1149 1150 1151
2023 1152 1153 1154 1155
2024 1156 1157 1158 1159
2025 1160 1161 1162 1163
2026 1164 1165 1166 1167
2027 1168 1169 1170 1171
2028 1172 1173 1174 1175
2029 1176 1177 1178 1179
2030 1180 1181 1182 1183
2031 1184 1185 1186 1187
2032 1188 1189 1190 1191
2033 1192 1193 1194 1195
2034 1196 1197 1198 1199
2035 1200
</pre></div>


<p>Converting time series to monthly data.</p>
<div class="highlight"><pre><span></span><span class="c1">#converting the numbers to time series. Frequency of 12 indicating monthly</span>
ts<span class="p">(</span>tsData<span class="p">,</span> frequency <span class="o">=</span> <span class="m">12</span><span class="p">,</span>start <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2010</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec
2010 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111
2011 1112 1113 1114 1115 1116 1117 1118 1119 1120 1121 1122 1123
2012 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134 1135
2013 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147
2014 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159
2015 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171
2016 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183
2017 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195
2018 1196 1197 1198 1199 1200
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#converting the numbers to time series with frequency 1.</span>
ts<span class="p">(</span>tsData<span class="p">,</span> frequency <span class="o">=</span> <span class="m">1</span><span class="p">,</span>start <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2010</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>Time Series:
Start = 2010 
End = 2110 
Frequency = 1 
  [1] 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114
 [16] 1115 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129
 [31] 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144
 [46] 1145 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159
 [61] 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172 1173 1174
 [76] 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186 1187 1188 1189
 [91] 1190 1191 1192 1193 1194 1195 1196 1197 1198 1199 1200
</pre></div>


<p>Starting with the Air Passengers data for analysis.</p>
<div class="highlight"><pre><span></span><span class="c1">#AirPassengers data</span>
ts_ap <span class="o">&lt;-</span> AirPassengers
ts_ap
</pre></div>


<div class="highlight"><pre><span></span>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126 141 135 125 149 170 170 158 133 114 140
1951 145 150 178 163 172 178 199 199 184 162 146 166
1952 171 180 193 181 183 218 230 242 209 191 172 194
1953 196 196 236 235 229 243 264 272 237 211 180 201
1954 204 188 235 227 234 264 302 293 259 229 203 229
1955 242 233 267 269 270 315 364 347 312 274 237 278
1956 284 277 317 313 318 374 413 405 355 306 271 306
1957 315 301 356 348 355 422 465 467 404 347 305 336
1958 340 318 362 348 363 435 491 505 404 359 310 337
1959 360 342 406 396 420 472 548 559 463 407 362 405
1960 417 391 419 461 472 535 622 606 508 461 390 432
</pre></div>


<p>Visualization of the Air Passengers data on a graph.</p>
<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
plot<span class="p">(</span>ts_ap<span class="p">,</span>col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span>main<span class="o">=</span><span class="s">&#39;Air Passengers graph&#39;</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">&#39;Air Passengers&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_6_0.png"></p>
<p>Components of a time series are seasonality, trend, cyclicity and irregularity. We can structure the data in two ways - additive model and multiplicative model. </p>
<p>Yt = St + Tt + et ----additive model</p>
<p>Yt = St * Tt * et ----multiplicative model</p>
<p>One can convert a multiplicative time series into an additive time series by using logarithimic transformation</p>
<div class="highlight"><pre><span></span><span class="c1"># Assumptions of a time series forecasting model</span>

<span class="c1">#1- Time is continuous</span>
<span class="c1">#2- Data has Stationarity:</span>
    <span class="c1">#1- mean value is constant over time, there is no trend component</span>
    <span class="c1">#2- variance does not increase over time </span>
    <span class="c1">#3- there is no seasonality</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">print</span><span class="p">(</span>decompose<span class="p">(</span>ts_ap<span class="p">,</span>type <span class="o">=</span> <span class="s">&#39;additive&#39;</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>$x
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126 141 135 125 149 170 170 158 133 114 140
1951 145 150 178 163 172 178 199 199 184 162 146 166
1952 171 180 193 181 183 218 230 242 209 191 172 194
1953 196 196 236 235 229 243 264 272 237 211 180 201
1954 204 188 235 227 234 264 302 293 259 229 203 229
1955 242 233 267 269 270 315 364 347 312 274 237 278
1956 284 277 317 313 318 374 413 405 355 306 271 306
1957 315 301 356 348 355 422 465 467 404 347 305 336
1958 340 318 362 348 363 435 491 505 404 359 310 337
1959 360 342 406 396 420 472 548 559 463 407 362 405
1960 417 391 419 461 472 535 622 606 508 461 390 432

$seasonal
            Jan        Feb        Mar        Apr        May        Jun
1949 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1950 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1951 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1952 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1953 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1954 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1955 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1956 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1957 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1958 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1959 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
1960 -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
            Jul        Aug        Sep        Oct        Nov        Dec
1949  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1950  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1951  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1952  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1953  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1954  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1955  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1956  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1957  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1958  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1959  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949
1960  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949

$trend
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
1949       NA       NA       NA       NA       NA       NA 126.7917 127.2500
1950 131.2500 133.0833 134.9167 136.4167 137.4167 138.7500 140.9167 143.1667
1951 157.1250 159.5417 161.8333 164.1250 166.6667 169.0833 171.2500 173.5833
1952 183.1250 186.2083 189.0417 191.2917 193.5833 195.8333 198.0417 199.7500
1953 215.8333 218.5000 220.9167 222.9167 224.0833 224.7083 225.3333 225.3333
1954 228.0000 230.4583 232.2500 233.9167 235.6250 237.7500 240.5000 243.9583
1955 261.8333 266.6667 271.1250 275.2083 278.5000 281.9583 285.7500 289.3333
1956 309.9583 314.4167 318.6250 321.7500 324.5000 327.0833 329.5417 331.8333
1957 348.2500 353.0000 357.6250 361.3750 364.5000 367.1667 369.4583 371.2083
1958 375.2500 377.9167 379.5000 380.0000 380.7083 380.9583 381.8333 383.6667
1959 402.5417 407.1667 411.8750 416.3333 420.5000 425.5000 430.7083 435.1250
1960 456.3333 461.3750 465.2083 469.3333 472.7500 475.0417       NA       NA
          Sep      Oct      Nov      Dec
1949 127.9583 128.5833 129.0000 129.7500
1950 145.7083 148.4167 151.5417 154.7083
1951 175.4583 176.8333 178.0417 180.1667
1952 202.2083 206.2500 210.4167 213.3750
1953 224.9583 224.5833 224.4583 225.5417
1954 247.1667 250.2500 253.5000 257.1250
1955 293.2500 297.1667 301.0000 305.4583
1956 334.4583 337.5417 340.5417 344.0833
1957 372.1667 372.4167 372.7500 373.6250
1958 386.5000 390.3333 394.7083 398.6250
1959 437.7083 440.9583 445.8333 450.6250
1960       NA       NA       NA       NA

$random
             Jan         Feb         Mar         Apr         May         Jun
1949          NA          NA          NA          NA          NA          NA
1950   8.4987374  29.1047980   8.3244949   6.6199495  -7.9103535 -25.1527778
1951  12.6237374  26.6464646  18.4078283   6.9116162   9.8396465 -26.4861111
1952  12.6237374  29.9797980   6.1994949  -2.2550505  -6.0770202 -13.2361111
1953   4.9154040  13.6881313  17.3244949  20.1199495   9.4229798 -17.1111111
1954   0.7487374  -6.2702020   4.9911616   1.1199495   2.8813131  -9.1527778
1955   4.9154040   2.5214646  -1.8838384   1.8282828  -3.9936869  -2.3611111
1956  -1.2095960  -1.2285354   0.6161616  -0.7133838  -1.9936869  11.5138889
1957  -8.5012626 -15.8118687   0.6161616  -5.3383838  -4.9936869  19.4305556
1958 -10.5012626 -23.7285354 -15.2588384 -23.9633838 -13.2020202  18.6388889
1959 -17.7929293 -28.9785354  -3.6338384 -12.2967172   4.0063131  11.0972222
1960 -14.5845960 -34.1868687 -43.9671717  -0.2967172   3.7563131  24.5555556
             Jul         Aug         Sep         Oct         Nov         Dec
1949 -42.6224747 -42.0732323  -8.4785354  11.0593434  28.5934343  16.8699495
1950 -34.7474747 -35.9898990  -4.2285354   5.2260101  16.0517677  13.9116162
1951 -36.0808081 -37.4065657  -7.9785354   5.8093434  21.5517677  14.4532828
1952 -31.8724747 -20.5732323  -9.7285354   5.3926768  15.1767677   9.2449495
1953 -25.1641414 -16.1565657  -4.4785354   7.0593434   9.1351010   4.0782828
1954  -2.3308081 -13.7815657  -4.6868687  -0.6073232   3.0934343   0.4949495
1955  14.4191919  -5.1565657   2.2297980  -2.5239899 -10.4065657   1.1616162
1956  19.6275253  10.3434343   4.0214646 -10.8989899 -15.9482323  -9.4633838
1957  31.7108586  32.9684343  15.3131313  -4.7739899 -14.1565657  -9.0050505
1958  45.3358586  58.5101010   0.9797980 -10.6906566 -31.1148990 -33.0050505
1959  53.4608586  61.0517677   8.7714646 -13.3156566 -30.2398990 -17.0050505
1960          NA          NA          NA          NA          NA          NA

$figure
 [1] -24.748737 -36.188131  -2.241162  -8.036616  -4.506313  35.402778
 [7]  63.830808  62.823232  16.520202 -20.642677 -53.593434 -28.619949

$type
[1] &quot;additive&quot;

attr(,&quot;class&quot;)
[1] &quot;decomposed.ts&quot;
</pre></div>


<div class="highlight"><pre><span></span>decompose<span class="p">(</span>ts_ap<span class="p">,</span>type <span class="o">=</span> <span class="s">&#39;multiplicative&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>$x
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126 141 135 125 149 170 170 158 133 114 140
1951 145 150 178 163 172 178 199 199 184 162 146 166
1952 171 180 193 181 183 218 230 242 209 191 172 194
1953 196 196 236 235 229 243 264 272 237 211 180 201
1954 204 188 235 227 234 264 302 293 259 229 203 229
1955 242 233 267 269 270 315 364 347 312 274 237 278
1956 284 277 317 313 318 374 413 405 355 306 271 306
1957 315 301 356 348 355 422 465 467 404 347 305 336
1958 340 318 362 348 363 435 491 505 404 359 310 337
1959 360 342 406 396 420 472 548 559 463 407 362 405
1960 417 391 419 461 472 535 622 606 508 461 390 432

$seasonal
           Jan       Feb       Mar       Apr       May       Jun       Jul
1949 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1950 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1951 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1952 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1953 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1954 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1955 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1956 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1957 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1958 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1959 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
1960 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
           Aug       Sep       Oct       Nov       Dec
1949 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1950 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1951 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1952 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1953 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1954 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1955 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1956 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1957 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1958 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1959 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244
1960 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244

$trend
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
1949       NA       NA       NA       NA       NA       NA 126.7917 127.2500
1950 131.2500 133.0833 134.9167 136.4167 137.4167 138.7500 140.9167 143.1667
1951 157.1250 159.5417 161.8333 164.1250 166.6667 169.0833 171.2500 173.5833
1952 183.1250 186.2083 189.0417 191.2917 193.5833 195.8333 198.0417 199.7500
1953 215.8333 218.5000 220.9167 222.9167 224.0833 224.7083 225.3333 225.3333
1954 228.0000 230.4583 232.2500 233.9167 235.6250 237.7500 240.5000 243.9583
1955 261.8333 266.6667 271.1250 275.2083 278.5000 281.9583 285.7500 289.3333
1956 309.9583 314.4167 318.6250 321.7500 324.5000 327.0833 329.5417 331.8333
1957 348.2500 353.0000 357.6250 361.3750 364.5000 367.1667 369.4583 371.2083
1958 375.2500 377.9167 379.5000 380.0000 380.7083 380.9583 381.8333 383.6667
1959 402.5417 407.1667 411.8750 416.3333 420.5000 425.5000 430.7083 435.1250
1960 456.3333 461.3750 465.2083 469.3333 472.7500 475.0417       NA       NA
          Sep      Oct      Nov      Dec
1949 127.9583 128.5833 129.0000 129.7500
1950 145.7083 148.4167 151.5417 154.7083
1951 175.4583 176.8333 178.0417 180.1667
1952 202.2083 206.2500 210.4167 213.3750
1953 224.9583 224.5833 224.4583 225.5417
1954 247.1667 250.2500 253.5000 257.1250
1955 293.2500 297.1667 301.0000 305.4583
1956 334.4583 337.5417 340.5417 344.0833
1957 372.1667 372.4167 372.7500 373.6250
1958 386.5000 390.3333 394.7083 398.6250
1959 437.7083 440.9583 445.8333 450.6250
1960       NA       NA       NA       NA

$random
           Jan       Feb       Mar       Apr       May       Jun       Jul
1949        NA        NA        NA        NA        NA        NA 0.9516643
1950 0.9626030 1.0714668 1.0374474 1.0140476 0.9269030 0.9650406 0.9835566
1951 1.0138446 1.0640180 1.0918541 1.0176651 1.0515825 0.9460444 0.9474041
1952 1.0258814 1.0939696 1.0134734 0.9695596 0.9632673 1.0003735 0.9468562
1953 0.9976684 1.0151646 1.0604644 1.0802327 1.0413329 0.9718056 0.9551933
1954 0.9829785 0.9232032 1.0044417 0.9943899 1.0119479 0.9978740 1.0237753
1955 1.0154046 0.9888241 0.9775844 1.0015732 0.9878755 1.0039635 1.0385512
1956 1.0066157 0.9970250 0.9876248 0.9968224 0.9985644 1.0275560 1.0217685
1957 0.9937293 0.9649918 0.9881769 0.9867637 0.9924177 1.0328601 1.0261250
1958 0.9954212 0.9522762 0.9469115 0.9383993 0.9715785 1.0261340 1.0483841
1959 0.9825176 0.9505736 0.9785278 0.9746440 1.0177637 0.9968613 1.0373136
1960 1.0039279 0.9590794 0.8940857 1.0064948 1.0173588 1.0120790        NA
           Aug       Sep       Oct       Nov       Dec
1949 0.9534014 1.0022198 1.0040278 1.0062701 1.0118119
1950 0.9733720 1.0225047 0.9721928 0.9389527 1.0067914
1951 0.9397599 0.9888637 0.9938809 1.0235337 1.0250824
1952 0.9931171 0.9746302 1.0046687 1.0202797 1.0115407
1953 0.9894989 0.9934337 1.0192680 1.0009392 0.9915039
1954 0.9845184 0.9881036 0.9927613 0.9995143 0.9908692
1955 0.9831117 1.0032501 1.0003084 0.9827720 1.0125535
1956 1.0004765 1.0008730 0.9835071 0.9932761 0.9894251
1957 1.0312668 1.0236147 1.0108432 1.0212995 1.0005263
1958 1.0789695 0.9856540 0.9977971 0.9802940 0.9405687
1959 1.0531001 0.9974447 1.0013371 1.0134608 0.9999192
1960        NA        NA        NA        NA        NA

$figure
 [1] 0.9102304 0.8836253 1.0073663 0.9759060 0.9813780 1.1127758 1.2265555
 [8] 1.2199110 1.0604919 0.9217572 0.8011781 0.8988244

$type
[1] &quot;multiplicative&quot;

attr(,&quot;class&quot;)
[1] &quot;decomposed.ts&quot;
</pre></div>


<p>We can decompose the time series data using stl() function. The Seasonal Trend Decomposition using Loess (STL) is an algorithm that was developed to help divide up a time series into three components namely: the trend, seasonality and remainder. Now that we have the STL decomposition there is a plot function provided for the object created from a call to stl.</p>
<div class="highlight"><pre><span></span>stl<span class="p">(</span>ts_ap<span class="p">,</span>s.window<span class="o">=</span><span class="s">&#39;periodic&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span> Call:
 stl(x = ts_ap, s.window = &quot;periodic&quot;)

Components
           seasonal    trend    remainder
Jan 1949 -25.497718 127.1873  10.31036990
Feb 1949 -35.220935 126.6495  26.57140282
Mar 1949  -3.027478 126.1117   8.91576248
Apr 1949  -8.299054 126.1989  11.10012240
May 1949  -5.737289 126.2861   0.45114078
Jun 1949  32.336634 126.7330 -24.06965722
Jul 1949  70.243882 127.1799 -49.42377968
Aug 1949  68.049433 127.4162 -47.46564918
Sep 1949  17.438326 127.6525  -9.09086079
Oct 1949 -21.063432 129.0186  11.04484245
Nov 1949 -57.481851 130.3846  31.09720711
Dec 1949 -31.740516 132.3618  17.37867988
Jan 1950 -25.497718 134.3390   6.15869051
Feb 1950 -35.220935 135.1084  26.11257707
Mar 1950  -3.027478 135.8777   8.14979039
Apr 1950  -8.299054 135.9454   7.35364819
May 1950  -5.737289 136.0131  -5.27583556
Jun 1950  32.336634 137.2093 -20.54595443
Jul 1950  70.243882 138.4055 -38.64939776
Aug 1950  68.049433 141.3114 -39.36083873
Sep 1950  17.438326 144.2173  -3.65562181
Oct 1950 -21.063432 148.3371   5.72636661
Nov 1950 -57.481851 152.4568  19.02501645
Dec 1950 -31.740516 156.1257  15.61485924
Jan 1951 -25.497718 159.7945  10.70323988
Feb 1951 -35.220935 161.6914  23.52950035
Mar 1951  -3.027478 163.5884  17.43908757
Apr 1951  -8.299054 164.6017   6.69738099
May 1951  -5.737289 165.6150  12.12233287
Jun 1951  32.336634 167.2285 -21.56509136
Jul 1951  70.243882 168.8420 -40.08584006
Aug 1951  68.049433 171.2070 -40.25645599
Sep 1951  17.438326 173.5721  -7.01041404
Oct 1951 -21.063432 176.5526   6.51079382
Nov 1951 -57.481851 179.5332  23.94866309
Dec 1951 -31.740516 182.6278  15.11274939
Jan 1952 -25.497718 185.7223  10.77537354
Feb 1952 -35.220935 187.8163  27.40461728
Mar 1952  -3.027478 189.9103   6.11718778
Apr 1952  -8.299054 191.1312  -1.83211324
May 1952  -5.737289 192.3520  -3.61475580
Jun 1952  32.336634 194.0658  -8.40245074
Jul 1952  70.243882 195.7796 -36.02347015
Aug 1952  68.049433 198.7814 -24.83081992
Sep 1952  17.438326 201.7832 -10.22151180
Oct 1952 -21.063432 206.0687   5.99474323
Nov 1952 -57.481851 210.3542  19.12765967
Dec 1952 -31.740516 214.1849  11.55563782
Jan 1953 -25.497718 218.0156   3.48215382
Feb 1953 -35.220935 220.1263  11.09459538
Mar 1953  -3.027478 222.2371  16.79036369
Apr 1953  -8.299054 222.9376  20.36148810
May 1953  -5.737289 223.6380  11.09927096
Jun 1953  32.336634 223.7928 -13.12945404
Jul 1953  70.243882 223.9476 -30.19150350
Aug 1953  68.049433 223.9443 -19.99370772
Sep 1953  17.438326 223.9409  -4.37925407
Oct 1953 -21.063432 224.5947   7.46868162
Nov 1953 -57.481851 225.2486  12.23327872
Dec 1953 -31.740516 227.0215   5.71901399
Jan 1954 -25.497718 228.7944   0.70328710
Feb 1954 -35.220935 230.5535  -7.33257110
Mar 1954  -3.027478 232.3126   5.71489744
Apr 1954  -8.299054 233.8328   1.46622217
May 1954  -5.737289 235.3531   4.38420535
Jun 1954  32.336634 237.7041  -6.04073406
Jul 1954  70.243882 240.0551  -8.29899793
Aug 1954  68.049433 243.2465 -18.29598169
Sep 1954  17.438326 246.4380  -4.87630758
Oct 1954 -21.063432 250.1037  -0.04022517
Nov 1954 -57.481851 253.7693   6.71251865
Dec 1954 -31.740516 258.0836   2.65690861
Jan 1955 -25.497718 262.3979   5.09983643
Feb 1955 -35.220935 266.7545   1.46642081
Mar 1955  -3.027478 271.1111  -1.08366806
Apr 1955  -8.299054 274.8384   2.46064436
May 1955  -5.737289 278.5657  -2.82838476
Jun 1955  32.336634 282.0862   0.57720167
Jul 1955  70.243882 285.6067   8.14946363
Aug 1955  68.049433 289.3515 -10.40093208
Sep 1955  17.438326 293.0963   1.46533009
Oct 1955 -21.063432 297.0760  -2.01260749
Nov 1955 -57.481851 301.0557  -6.57388365
Dec 1955 -31.740516 305.4064   4.33415306
Jan 1956 -25.497718 309.7570  -0.25927237
Feb 1956 -35.220935 314.0295  -1.80854607
Mar 1956  -3.027478 318.3020   1.72550697
Apr 1956  -8.299054 321.7071  -0.40801520
May 1956  -5.737289 325.1122  -1.37487891
Jun 1956  32.336634 327.6514  14.01197715
Jul 1956  70.243882 330.1906  12.56550875
Aug 1956  68.049433 332.4831   4.46746283
Sep 1956  17.438326 334.7756   2.78607479
Oct 1956 -21.063432 337.3493 -10.28586362
Nov 1956 -57.481851 339.9230 -11.44114062
Dec 1956 -31.740516 343.5618  -5.82125409
Jan 1957 -25.497718 347.2005  -6.70282970
Feb 1957 -35.220935 351.9113 -15.69035040
Mar 1957  -3.027478 356.6220   2.40545565
Apr 1957  -8.299054 360.9900  -4.69097044
May 1957  -5.737289 365.3580  -4.62073808
Jun 1957  32.336634 368.2253  21.43804701
Jul 1957  70.243882 371.0926  23.66350763
Aug 1957  68.049433 372.2017  26.74885447
Sep 1957  17.438326 373.3108  13.25085918
Oct 1957 -21.063432 373.0689  -5.00549738
Nov 1957 -57.481851 372.8270 -10.34519253
Dec 1957 -31.740516 373.1663  -5.42583158
Jan 1958 -25.497718 373.5057  -8.00793278
Feb 1958 -35.220935 375.3037 -22.08276520
Mar 1958  -3.027478 377.1017 -12.07427088
Apr 1958  -8.299054 379.1766 -22.87753414
May 1958  -5.737289 381.2514 -12.51413896
Jun 1958  32.336634 382.8734  19.78995191
Jul 1958  70.243882 384.4954  36.26071831
Aug 1958  68.049433 386.4129  50.53766559
Sep 1958  17.438326 388.3304  -1.76872925
Oct 1958 -21.063432 390.6746 -10.61113352
Nov 1958 -57.481851 393.0187 -25.53687639
Dec 1958 -31.740516 396.3416 -27.60108633
Jan 1959 -25.497718 399.6645 -14.16675842
Feb 1959 -35.220935 404.9035 -27.68255170
Mar 1959  -3.027478 410.1425  -1.11501823
Apr 1959  -8.299054 416.3450 -12.04590874
May 1959  -5.737289 422.5474   3.18985921
Jun 1959  32.336634 427.7897  11.87371232
Jul 1959  70.243882 433.0319  44.72424096
Aug 1959  68.049433 436.4362  54.51433014
Sep 1959  17.438326 439.8406   5.72107719
Oct 1959 -21.063432 442.3755 -14.31206868
Nov 1959 -57.481851 444.9104 -25.42855315
Dec 1959 -31.740516 448.6402 -11.89966612
Jan 1960 -25.497718 452.3700  -9.87224124
Feb 1960 -35.220935 457.8121 -31.59119510
Mar 1960  -3.027478 463.2543 -41.22682221
Apr 1960  -8.299054 467.6104   1.68863111
May 1960  -5.737289 471.9665   5.77074288
Jun 1960  32.336634 475.6083  27.05506691
Jul 1960  70.243882 479.2501  72.50606647
Aug 1960  68.049433 483.1894  54.76116520
Sep 1960  17.438326 487.1288   3.43292181
Oct 1960 -21.063432 490.7530  -8.68958822
Nov 1960 -57.481851 494.3773 -46.89543684
Dec 1960 -31.740516 497.4299 -33.68938955
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Plotting the decomposed data</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
plot<span class="p">(</span>stl<span class="p">(</span>ts_ap<span class="p">,</span>s.window<span class="o">=</span><span class="s">&#39;periodic&#39;</span><span class="p">),</span>main<span class="o">=</span><span class="s">&#39;Decomposition of periodic time series&#39;</span><span class="p">)</span>
plot<span class="p">(</span>decompose<span class="p">(</span>ts_ap<span class="p">,</span>type <span class="o">=</span> <span class="s">&#39;multiplicative&#39;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_12_0.png"></p>
<p><img alt="png" src="/images/airpsg_12_1.png"></p>
<p>To forecast we are using standard regression based methods. For regression, we need dependent and independent variables.
In our case, dependent variable is 'ts_ap' (AirPassengers) which is known as Yt, independent predictors are either lag values, or moving average values, or difference values or all or combinations of any sort etc.</p>
<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>lag<span class="p">(</span>ts_ap<span class="p">),</span><span class="m">10</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1948                                             112
1949 118 132 129 121 135 148 148 136 119
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>lag<span class="p">(</span>ts_ap<span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">10</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1948                                             112
1949 118 132 129 121 135 148 148 136 119
</pre></div>


<p>Here lead is positive values shifted to earlier stage and lag is negative values shifted to later stage.</p>
<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>lag<span class="p">(</span>ts_ap<span class="p">,</span><span class="m">-1</span><span class="p">),</span><span class="m">10</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>     Feb Mar Apr May Jun Jul Aug Sep Oct Nov
1949 112 118 132 129 121 135 148 148 136 119
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span><span class="kp">as.data.frame</span><span class="p">(</span>ts_ap<span class="p">),</span><span class="m">10</span><span class="p">)</span>
</pre></div>


<table>
<thead><tr><th scope=col>x</th></tr></thead>
<tbody>
    <tr><td>112</td></tr>
    <tr><td>118</td></tr>
    <tr><td>132</td></tr>
    <tr><td>129</td></tr>
    <tr><td>121</td></tr>
    <tr><td>135</td></tr>
    <tr><td>148</td></tr>
    <tr><td>148</td></tr>
    <tr><td>136</td></tr>
    <tr><td>119</td></tr>
</tbody>
</table>

<p>We'll find the autocorrelation and partial autocorrelation for the time series data. The function Acf computes (and by default plots) an estimate of the autocorrelation function of a (possibly multivariate) time series. Function Pacf computes (and by default plots) an estimate of the partial autocorrelation function of a (possibly multivariate) time series. </p>
<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
acf<span class="p">(</span>ts_ap<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Series Air Passengers&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_20_0.png"></p>
<p>The acf from the above graph indicates that the time series is not stationary</p>
<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
pacf<span class="p">(</span>ts_ap<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Series Air Passengers&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_22_0.png"></p>
<p>The graph looks fine from pacf angle.</p>
<div class="highlight"><pre><span></span><span class="c1">#de-trend a time series</span>
lm<span class="p">(</span>JohnsonJohnson <span class="o">~</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="kp">length</span><span class="p">(</span>JohnsonJohnson<span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Call</span><span class="o">:</span>
<span class="n">lm</span><span class="o">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">JohnsonJohnson</span> <span class="o">~</span> <span class="n">c</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="o">(</span><span class="n">JohnsonJohnson</span><span class="o">)))</span>

<span class="n">Coefficients</span><span class="o">:</span>
                <span class="o">(</span><span class="n">Intercept</span><span class="o">)</span>  <span class="n">c</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="o">(</span><span class="n">JohnsonJohnson</span><span class="o">))</span>  
                     <span class="o">-</span><span class="mf">2.130</span>                        <span class="mf">0.163</span>
</pre></div>


<div class="highlight"><pre><span></span>fit <span class="o">&lt;-</span> lm<span class="p">(</span>JohnsonJohnson <span class="o">~</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="kp">length</span><span class="p">(</span>JohnsonJohnson<span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
plot<span class="p">(</span>JohnsonJohnson<span class="p">)</span>
plot<span class="p">(</span>resid<span class="p">(</span>fit<span class="p">),</span>type<span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_26_0.png"></p>
<p>To de-seasonalize a time series, we first de-compose the time series and then use seasonal adjustment.</p>
<div class="highlight"><pre><span></span>ts_ds_ap_p <span class="o">&lt;-</span> stl<span class="p">(</span>ts_ap<span class="p">,</span><span class="s">&#39;periodic&#39;</span><span class="p">)</span>
ts_ds_ap_adj <span class="o">&lt;-</span> seasadj<span class="p">(</span>ts_ds_ap_p<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
plot<span class="p">(</span>ts_ap<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Graph of Air Passengers&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Air Passengers&#39;</span><span class="p">)</span>
plot<span class="p">(</span>ts_ds_ap_adj<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Seasonally adjusted graph of Air Passengers&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Seas-adj data&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_29_0.png"></p>
<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
seasonplot<span class="p">(</span>ts_ds_ap_adj<span class="p">,</span><span class="m">12</span><span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Seaonal plot&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_30_0.png"></p>
<p>Checking if the time series is stationary using ADF test (Augmented Dickey Fuller Test ).</p>
<p>Null Hypothesis: The time series is not stationary.<br/>
Alternative Hypothesis: The time series is stationary.</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>tseries<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>adf.test<span class="p">(</span>ts_ap<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in adf.test(ts_ap):
&quot;p-value smaller than printed p-value&quot;



    Augmented Dickey-Fuller Test

data:  ts_ap
Dickey-Fuller = -7.3186, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary
</pre></div>


<p>Since the p-value of the ADF test is less than 0.05, we fail to reject the null hypothesis, hence the time series is not stationary.</p>
<p>Null Hypothesis: The time series is stationary<br/>
Alternate Hypothesis: The time series is not stationary</p>
<div class="highlight"><pre><span></span>kpss.test<span class="p">(</span>ts_ap<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in kpss.test(ts_ap):
&quot;p-value smaller than printed p-value&quot;



    KPSS Test for Level Stationarity

data:  ts_ap
KPSS Level = 4.3423, Truncation lag parameter = 2, p-value = 0.01
</pre></div>


<p>Since the p-value of the kpss test is less than 0.05, we have to reject the null hypothesis,
hence the time series is not stationary.</p>
<p>Using Differencing method to make the time series stationary</p>
<div class="highlight"><pre><span></span><span class="c1"># seasonal differencing</span>
<span class="c1"># number of diff required to make the time series stationary</span>
ndiffs<span class="p">(</span>ts_ap<span class="p">)</span> 
</pre></div>


<p>1</p>
<div class="highlight"><pre><span></span>ts_ap_sa <span class="o">&lt;-</span> <span class="kp">diff</span><span class="p">(</span>AirPassengers<span class="p">,</span>lag<span class="o">=</span>frequency<span class="p">(</span>AirPassengers<span class="p">),</span>differences <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>ts_AP_SA_diff_1 <span class="o">&lt;-</span> <span class="kp">diff</span><span class="p">(</span>ts_ap_sa<span class="p">,</span>differences <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
plot<span class="p">(</span>ts_ap<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Air Passengers&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;AirPassengers&#39;</span><span class="p">)</span>
plot<span class="p">(</span>ts_ap_sa<span class="p">,</span>type<span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Difference 1&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Diff=1&#39;</span><span class="p">)</span>
plot<span class="p">(</span>ts_AP_SA_diff_1<span class="p">,</span>type<span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Difference in differences&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;DID&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_43_0.png"></p>
<div class="highlight"><pre><span></span>ndiffs<span class="p">(</span>ts_ap_sa<span class="p">)</span>
</pre></div>


<p>1</p>
<p>One can check and proceed to maximum diff 2 taken step by step, 1 at a time.</p>
<p>Showing 12 period moving average, 3 period moving average, 5 period moving average and 7 period moving average plots.</p>
<p><img alt="png" src="/images/airpsg_50_0.png"></p>
<p><img alt="png" src="/images/airpsg_50_1.png"></p>
<h4>ARIMA - Auto regressive integrated moving average model</h4>
<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>AirPassengers<span class="p">,</span><span class="m">10</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct
1949 112 118 132 129 121 135 148 148 136 119
</pre></div>


<p>Steps in ARIMA: Plot the series and understand the components.</p>
<div class="highlight"><pre><span></span>plot<span class="p">(</span>ts_ap<span class="p">,</span>main<span class="o">=</span><span class="s">&#39;Air Passengers&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Air Passengers&#39;</span><span class="p">)</span>
plot<span class="p">(</span><span class="kp">log</span><span class="p">(</span>ts_ap<span class="p">),</span>main<span class="o">=</span><span class="s">&#39;Log of Air Passengers&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;log(AirPassengers)&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_65_0.png"></p>
<p><img alt="png" src="/images/airpsg_65_1.png"></p>
<p>Decompose the time series and check for stationarity.</p>
<div class="highlight"><pre><span></span>adf.test<span class="p">(</span>ts_ap<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in adf.test(ts_ap):
&quot;p-value smaller than printed p-value&quot;



    Augmented Dickey-Fuller Test

data:  ts_ap
Dickey-Fuller = -7.3186, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary
</pre></div>


<div class="highlight"><pre><span></span>adf.test<span class="p">(</span><span class="kp">log</span><span class="p">(</span>ts_ap<span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in adf.test(log(ts_ap)):
&quot;p-value smaller than printed p-value&quot;



    Augmented Dickey-Fuller Test

data:  log(ts_ap)
Dickey-Fuller = -6.4215, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary
</pre></div>


<div class="highlight"><pre><span></span>adf.test<span class="p">(</span><span class="kp">log</span><span class="p">(</span><span class="kp">log</span><span class="p">(</span>ts_ap<span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in adf.test(log(log(ts_ap))):
&quot;p-value smaller than printed p-value&quot;



    Augmented Dickey-Fuller Test

data:  log(log(ts_ap))
Dickey-Fuller = -5.5377, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary
</pre></div>


<p>Non-seasonal <a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average">ARIMA</a> models are generally denoted ARIMA(p,d,q) and Seasonal ARIMA models are usually denoted ARIMA(p,d,q)(P,D,Q)m.</p>
<div class="highlight"><pre><span></span>data <span class="o">=</span> <span class="kt">data.frame</span><span class="p">(</span>Yt<span class="o">=</span>AirPassengers<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>data<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th scope=col>Yt</th></tr></thead>
<tbody>
    <tr><td>112</td></tr>
    <tr><td>118</td></tr>
    <tr><td>132</td></tr>
    <tr><td>129</td></tr>
    <tr><td>121</td></tr>
    <tr><td>135</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>mov_avg_7 <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>mov_avg_7 <span class="o">=</span> ma<span class="p">(</span>AirPassengers<span class="p">,</span>order<span class="o">=</span><span class="m">7</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
</pre></div>


<p>Decompose and plot the time series data.</p>
<div class="highlight"><pre><span></span>decomp <span class="o">=</span> stl<span class="p">(</span>data<span class="o">$</span>Yt<span class="p">,</span>s.window <span class="o">=</span> <span class="s">&#39;periodic&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>plot<span class="p">(</span>seasadj<span class="p">(</span>decomp<span class="p">),</span>main<span class="o">=</span><span class="s">&#39;Seasonal adjustment on decomposed Air Passengers&#39;</span><span class="p">)</span> <span class="c1">#, ylab=&#39;Air Passengers&#39;)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_78_0.png"></p>
<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span><span class="kt">data.frame</span><span class="p">(</span>ma<span class="p">(</span>AirPassengers<span class="p">,</span>order<span class="o">=</span><span class="m">7</span><span class="p">)))</span>
</pre></div>


<table>
<thead><tr><th scope=col>ma.AirPassengers..order...7.</th></tr></thead>
<tbody>
    <tr><td>      NA</td></tr>
    <tr><td>      NA</td></tr>
    <tr><td>      NA</td></tr>
    <tr><td>127.8571</td></tr>
    <tr><td>133.0000</td></tr>
    <tr><td>135.5714</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>diff_ap_1 <span class="o">=</span> <span class="kp">diff</span><span class="p">(</span>AirPassengers<span class="p">,</span>differences <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
plot<span class="p">(</span>diff_ap_1<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Differences in 1&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Differences in 1&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_80_0.png"></p>
<div class="highlight"><pre><span></span>adf.test<span class="p">(</span>diff_ap_1<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Warning message in adf.test(diff_ap_1):
&quot;p-value smaller than printed p-value&quot;



    Augmented Dickey-Fuller Test

data:  diff_ap_1
Dickey-Fuller = -7.0177, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary
</pre></div>


<div class="highlight"><pre><span></span>par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
acf<span class="p">(</span>diff_ap_1<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Series differences&#39;</span><span class="p">)</span>
pacf<span class="p">(</span>diff_ap_1<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Series differences&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_82_0.png"></p>
<p>Fit best ARIMA model to time series.</p>
<div class="highlight"><pre><span></span>auto.arima<span class="p">(</span>AirPassengers<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Series</span><span class="o">:</span> <span class="n">AirPassengers</span> 
<span class="n">ARIMA</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">)(</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">0</span><span class="o">)[</span><span class="mi">12</span><span class="o">]</span>

<span class="n">Coefficients</span><span class="o">:</span>
         <span class="n">ar1</span>     <span class="n">ar2</span>      <span class="n">ma1</span>
      <span class="mf">0.5960</span>  <span class="mf">0.2143</span>  <span class="o">-</span><span class="mf">0.9819</span>
<span class="n">s</span><span class="o">.</span><span class="na">e</span><span class="o">.</span>  <span class="mf">0.0888</span>  <span class="mf">0.0880</span>   <span class="mf">0.0292</span>

<span class="n">sigma</span><span class="o">^</span><span class="mi">2</span> <span class="n">estimated</span> <span class="k">as</span> <span class="mf">132.3</span><span class="o">:</span>  <span class="n">log</span> <span class="n">likelihood</span><span class="o">=-</span><span class="mf">504.92</span>
<span class="n">AIC</span><span class="o">=</span><span class="mf">1017.85</span>   <span class="n">AICc</span><span class="o">=</span><span class="mf">1018.17</span>   <span class="n">BIC</span><span class="o">=</span><span class="mf">1029.35</span>
</pre></div>


<p>Print Accuracy for auto ARIMA model.</p>
<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>auto.arima<span class="p">(</span>AirPassengers<span class="p">))</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>1.3423     </td><td>10.84619   </td><td>7.86754    </td><td>0.420698   </td><td>2.800458   </td><td>0.245628   </td><td>-0.00124847</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>auto.arima<span class="p">(</span>AirPassengers<span class="p">,</span>seasonal <span class="o">=</span> <span class="bp">F</span><span class="p">))</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>-1.228696   </td><td>25.82793    </td><td>20.59211    </td><td>-1.665245   </td><td>7.476447    </td><td>0.6428946   </td><td>0.0009861072</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>auto.arima<span class="p">(</span>AirPassengers<span class="p">,</span>seasonal <span class="o">=</span> <span class="bp">T</span><span class="p">))</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>1.3423     </td><td>10.84619   </td><td>7.86754    </td><td>0.420698   </td><td>2.800458   </td><td>0.245628   </td><td>-0.00124847</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>model_ap_4 <span class="o">&lt;-</span> auto.arima<span class="p">(</span>AirPassengers<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>tsdisplay<span class="p">(</span>residuals<span class="p">(</span>model_ap_4<span class="p">),</span>lag.max<span class="o">=</span><span class="m">20</span><span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Residuals(auto arima)&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="/images/airpsg_88_0.png"></p>
<p>Fit ARIMA model to time series.</p>
<div class="highlight"><pre><span></span>model_with_111 <span class="o">&lt;-</span> arima<span class="p">(</span>AirPassengers<span class="p">,</span>order<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>model_with_111<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>1.9209    </td><td>30.91125  </td><td>24.12176  </td><td>0.4150742 </td><td>8.566115  </td><td>0.9327776 </td><td>0.03749257</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>model_ap_4<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>1.3423     </td><td>10.84619   </td><td>7.86754    </td><td>0.420698   </td><td>2.800458   </td><td>0.245628   </td><td>-0.00124847</td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>model_with_121 <span class="o">&lt;-</span> arima<span class="p">(</span>AirPassengers<span class="p">,</span>order<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>model_with_121<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>-0.02226461</td><td>31.9296    </td><td>24.74944   </td><td>-0.3318117 </td><td>8.700005   </td><td>0.9570499  </td><td>0.06233016 </td></tr>
</tbody>
</table>

<div class="highlight"><pre><span></span>model_with_125 <span class="o">&lt;-</span> arima<span class="p">(</span>AirPassengers<span class="p">,</span>order<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>accuracy<span class="p">(</span>model_with_125<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th></th><th scope=col>ME</th><th scope=col>RMSE</th><th scope=col>MAE</th><th scope=col>MPE</th><th scope=col>MAPE</th><th scope=col>MASE</th><th scope=col>ACF1</th></tr></thead>
<tbody>
    <tr><th scope=row>Training set</th><td>0.622786   </td><td>26.12974   </td><td>19.39259   </td><td>-0.2019999 </td><td>6.721384   </td><td>0.7499027  </td><td>-0.04625799</td></tr>
</tbody>
</table>

<p>Will show forecast for the future, using various forecasting models.</p>
<p><img alt="png" src="/images/airpsg_96_0.png"></p>
<p><img alt="png" src="/images/airpsg_97_0.png"></p>
<p><img alt="png" src="/images/airpsg_98_0.png"></p>
<p>Forecasts using auto ARIMA(2,1,1) model.</p>
<p><img alt="png" src="/images/airpsg_99_0.png"></p>
<p>Forecasts using ARIMA(1,1,1) model.</p>
<p><img alt="png" src="/images/airpsg_100_0.png"></p>
<p>Forecasts using ARIMA(1,2,1) model.</p>
<p><img alt="png" src="/images/airpsg_101_0.png"></p>
<p>Forecasts using auto ARIMA(1,2,5) model.</p>
<p><img alt="png" src="/images/airpsg_102_0.png"></p>
<h4>Neural Network Based Forecasting</h4>
<p>Series: AirPassengers<br/>
Model:  Average of 10 networks, each of which is a 12-10-1 network with 141 weights, options were - linear output units.<br/>
sigma^2 estimated as 0.0002052<br/>
Displaying neural network based forecasting and residuals.</p>
<p><img alt="png" src="/images/airpsg_110_0.png"></p>
<p><img alt="png" src="/images/airpsg_111_0.png"></p>
<p>Performing hyperparameter tuning to increase the model accuracy where<br/>
p= lags
P= seasonal lags<br/>
size= number of neurons in the hidden layer<br/>
lambda = learning rate<br/>
repeats = backpropagation<br/>
Plot the residuals for the NN Model(20, 1, 40).</p>
<p><img alt="png" src="/images/airpsg_114_0.png"></p>
<p>Neural network model(20, 1,40) forecast.</p>
<p><img alt="png" src="/images/airpsg_115_0.png"></p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Mangs
    </span>
  </span>
<time datetime="2017-12-30T07:20:00-08:00" pubdate>Sat 30 December 2017</time>  <span class="categories">
    <a class='category' href='/category/misc.html'>misc</a>
  </span>
  <span class="categories">
    <a class="category" href="/tag/r.html">R</a>,    <a class="category" href="/tag/data-science.html">Data Science</a>  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

</div>

<aside class="sidebar">
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    <li class="post">
        <a href="/sentiment.html">Sentiment Analysis</a>
    </li>
    <li class="post">
        <a href="/anna.html">Text Generation</a>
    </li>
    <li class="post">
        <a href="/wine.html">Wine Data Analysis</a>
    </li>
    <li class="post">
        <a href="/airpsg.html">Airline Passengers Data Analysis</a>
    </li>
    <li class="post">
        <a href="/tableau.html">Tableau Dashboard</a>
    </li>
  </ul>
</section><section>
  <h1>Categories</h1>
    <ul id="recent_posts">
      <li><a href="/category/misc.html">misc (5)</a></li>
  </ul>
</section>
<section>
  <h1>Tags</h1>
    <a href="/tag/r.html">R</a>,    <a href="/tag/python.html">Python</a>,    <a href="/tag/tableau.html">Tableau</a>,    <a href="/tag/data-science.html">Data Science</a></section>

</aside>
    </div>
  </div>
  <footer role="contentinfo">
<p>
    Copyright &copy;  2017  Mangs &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p>  </footer>
</body>
</html>